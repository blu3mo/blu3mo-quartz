---
title: アンビグラム自動生成
---

* *深層学習*的アプローチで*アンビグラム*作れないかな

* *東大1S情報α*でやってみたい気持ち
  
  * 余裕があれば*音声のアンビグラム*も
* 例えば、GANで人の顔を生成する時、そのまま版 & 上下逆版の両方を毎回Discriminatorに投げれば、人の顔写真のアンビグラム(?)が出来る

* 同じ事を、Conditional GANでやれば文字の生成も可能?

* 
   > 
   > [@nbaji9](https://twitter.com/nbaji9/status/1539485504303136768): 文字と絵が連動するアナグラム「dear / read」

* 
   > 
   > \#アナグラム絵 [https://t.co/wmuFtsGaTV](https://t.co/wmuFtsGaTV)
  
  * こういうやつの生成にも使える様なモデルがいいな
* ログ 20220606
  
  * たぶんデータ変えてもDCGANじゃないと厳しいので、とりあえずMNISTでDCGANを成功させる
  * その後、notMNISTってのが良さそうなので試す
  * DCGAN
    * 順転のみの時はうまくいく
    * アンビグラムすると、全然ダメなところで停滞してしまう
      * 汎化できていないと言う事だと思うので、Dropout高めてみる
      * 0とか1とか2みたいな簡単なのだとどうなる?<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>

        * 0は成功
        * 1も2回中1回成功
          * ![image](https://gyazo.com/c1a0f46f2e24cbf1d8c3927626dd46d1/thumb/1000)
            * MNISTと違って、常に右には傾いていないのはうまくいっている証拠<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>
    * notMNIST + DCGAN
      * ![image](https://gyazo.com/82531503131a0a5ae1c563d90f2464f6/thumb/1000)
        * 1000iter
        * まあ良い
      * ![image](https://gyazo.com/9eac9c3be64c4f032002edc529f9b708/thumb/1000)
        * 5000iter
        * 色々なスタイルが出ているのでnonMNISTを使った甲斐があった
      * これでアンビグラムをすると?
        * ![image](https://gyazo.com/514f86cbb0e6bee8ff8b0c8a1649a07e/thumb/1000)
        * 全然無理
      * 何が問題なんだろう
        * [https://gangango.com/2018/11/16/post-322/](https://gangango.com/2018/11/16/post-322/)
          * Discriminatorの頭が良すぎて、Generatorが学べる勾配が消滅してしまっている感じ?
            * これっぽいな<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>
            * Discriminatorをアホにすれば良いのかな
* ログ 20220523
  
  * とりあえず、*MNIST*で「9」を生成するGANを訓練してみる
    * 400 ![image](https://gyazo.com/6ec1bf4b0c54ea60f9119a3b40e4dfcd/thumb/1000)
    * できた✅
  * その上で、generaterの出力を半分上下反転でDiscriminatorに投げる様にしてみる
    * *Data Augmentation*に使った*RandomFlip*を使えば楽にできるな
    * RandomFlipをGeneratorの最後に
      * あれ、おかしいな
        * 1500 ![image](https://gyazo.com/57837b28d4d3b629103bf58bbee84f66/thumb/1000)
        * 普通に一方向だけの9が出てる..?
        * 両方でうまくいくのを諦めて、半分だけ9を出して50%で成功するところに落ち着いてしまった?
          * いや、そんなことはないわ
          * だとしても半分はひっくり返った9が出ているはず
        * [https://www.tensorflow.org/api_docs/python/tf/keras/layers/RandomFlip](https://www.tensorflow.org/api_docs/python/tf/keras/layers/RandomFlip)
        * 
           > 
           > During inference time, the output will be identical to input. Call the layer with training=True to flip the input.
          
          * これっぽい<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/><img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>
      * 他のやり方を見つけた
        * 3500 ![image](https://gyazo.com/ab059a4468c77d07fa4811277be8e8c9/thumb/1000)
        * うーん...w
        * 努力は認める<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>
        * 他の数字でも試す
          * 5
            * ![image](https://gyazo.com/181a3c7c8721e9f509d68b801f1d5c9d/thumb/1000)![image](https://gyazo.com/96695d696321e1f59b85cca27d7ae64c/thumb/1000)
      * *DCGAN*でも試す
        * 普通の5: ![image](https://gyazo.com/e3c24bb04326f27a024d4e72b26ff8da/thumb/1000)
          * まあ調整は必要そう
        * アンビグラム5: ![image](https://gyazo.com/f0077b5673297dfc4f62b178d0c01eba/thumb/1000)
          * 全然ダメだw
    * RandomFlipをDiscriminatorの最初に
      * これは、つまり上下反転の9も9と認識する様になる
      * ![image](https://gyazo.com/cc44f79e2138a380cc5e2fed63b8ac81/thumb/1000)
        * まあそうなるわな
        * どっちでも良いので、片方を出す様になる
        * これではだめ<img src='https://scrapbox.io/api/pages/blu3mo-public/blu3mo/icon' alt='blu3mo.icon' height="19.5"/>
    * とりあえずDCGANは放置して、普通のGANでデータセット増やす
      * LRDS [https://paperswithcode.com/dataset/letter](https://paperswithcode.com/dataset/letter)
        * ダメっぽい
        * これは文字画像ではなく、文字画像の特徴を抽出したデータセットっぽい
* \#実装するかも
